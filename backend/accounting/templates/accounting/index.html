{% extends 'base_extended.html' %}
{% load static %}
{% block title %}{{ title }}{% endblock %}

{% block content %}
<div style="padding-right: 100px; padding-left: 100px;">
    <div class="p-1 container row mb-2" style="margin: auto;">
        <div class="col-3"></div>
        <div class="col-6"><h2 class="p-2" style="text-align: center;">LIST</h2></div>
        <div class="col-3"  style="text-align: right; margin: auto;"><a href="{% url 'add_ticket' %}" class="p-2" style="color: black; text-decoration-line: none;">Add a ticket</a></div>
    </div>

    <div class="p-1 container">
        <div style="margin: auto;">
        <span class="badge bg-light text-dark">Filters:</span>
        <a href="{% url 'home' %}filter/{{ filter_by.waiting }}"><span class="badge" style="background-color: #f6d6ad; color: black;">Waiting</span></a>
        <a href="{% url 'home' %}filter/{{ filter_by.failure }}"><span class="badge" style="background-color: #f9c0c0; color: black;">Failure</span></a>
        <a href="{% url 'home' %}filter/{ filter_by.nothing }}"><span class="badge" style="background-color: #fafcc2; color: black;">Nothing</span></a>
        <a href="{% url 'home' %}filter/{{ filter_by.success }}"><span class="badge" style="background-color: #ccf6c8; color: black;">Success</span></a>
        <a href="{% url 'home' %}filter/{{ filter_by.bought_highest_to_lowest }}"><span class="badge" style="background-color: #ffd571; color: black;">Bought Highest</span></a>
        <a href="{% url 'home' %}filter/{{ filter_by.bought_lowest_to_highest }}"><span class="badge" style="background-color: #f4ebc1; color: black;">Bought Lowest</span></a>
        <a href="{% url 'home' %}filter/{{ filter_by.sold_highest_to_lowest }}"><span class="badge" style="background-color: #ffd571; color: black;">Sold Highest</span></a>
        <a href="{% url 'home' %}filter/{{ filter_by.sold_lowest_to_highest }}"><span class="badge" style="background-color: #f4ebc1; color: black;">Sold Lowest</span></a>
        <a href="{% url 'home' %}filter/{{ filter_by.profit_highest_to_lowest }}"><span class="badge" style="background-color: #ffd571; color: black;">Profit Highest</span></a>
        <a href="{% url 'home' %}filter/{{ filter_by.profit_lowest_to_highest }}"><span class="badge" style="background-color: #f4ebc1; color: black;">Profit Lowest</span></a>
        <a href="{% url 'home' %}filter/{{ filter_by.date_oldest }}"><span class="badge" style="background-color: #ff9a76; color: black;">Date Oldest</span></a>
        <a href="{% url 'home' %}"><span class="badge" style="background-color: #ea5455; color: black;">Reset</span></a>
        </div>
    </div>




    <div class="p-1 container p-2 border bg-light themed-container row mb-2" style="margin: auto;">
        <div class="col-4">Title</div>
        <div class="col-2">Bought</div>
        <div class="col-2">Sold</div>
        <div class="col-2">Profit</div>
        <div class="col-2">Date</div>
    </div>

    {% for ticket in tickets %}
        <a href="{{ ticket.get_absolute_url }}" style="color: black; text-decoration-line: none;">

        <div class="p-1 container themed-container p-2 border row mb-2" style="margin: auto; {% if ticket.profit > 0 %} background-color: #ccf6c8; {% elif ticket.profit < 0 %} background-color: #f9c0c0; {% elif ticket.profit == 0 %} background-color: #fafcc2; {% else %} background-color: #f6d6ad; {% endif %}">
            <div class="col-4">{{ ticket.title|truncatechars:43 }}</div>
            <div class="col-2">-{{ ticket.bought|floatformat:2 }}</div>
            <div class="col-2">
                {% if ticket.sold %}
                +{{ ticket.sold|floatformat:2 }}
                {% else %}
                -
                {% endif %}
            </div>
            <div class="col-2">
                {% if ticket.profit or ticket.profit == 0 %}
                {{ ticket.profit|floatformat:2  }}
                {% else %}
                -
                {% endif %}
            </div>
            <div class="col-2">{{ ticket.created_at|date:"d.m.Y"}}</div>
        </div>
        </a>
    {% endfor %}



    <div class="p-1 container row mb-2" style="margin: auto;">
        <div class="col-3"></div>

        <div class="col-6">
            {% if tickets.has_other_pages %}
            <nav aria-label="Page navigation example">
                <ul class="pagination justify-content-center">
                    {% if tickets.has_previous %}
                        <li class="page-item"><a class="page-link" style="color: black;" href="?page={{ tickets.previous_page_number }}">Previous</a></li>
                    {% else %}
                        <li class="page-item disabled"><a class="page-link" href="#">Previous</a></li>
                    {% endif %}

                        {% for p in tickets.paginator.page_range %}
                          {% if tickets.number == p %}
                            <li class="page-item disabled"><a class="page-link" style="color: #5067bc;">{{ p }}</a></li>
                          {% elif p > tickets.number|add:-3 and p < tickets.number|add:+3 %}
                            <li class="page-item"><a class="page-link" style="color: black;" href="?page={{ p }}">{{ p }}</a></li>
                          {% endif %}
                        {% endfor %}

                    {% if tickets.has_next %}
                        <li class="page-item"><a class="page-link" style="color: black;" href="?page={{ tickets.next_page_number }}">Next</a></li>
                    {% else %}
                        <li class="page-item disabled"><a class="page-link" href="#">Next</a></li>
                    {% endif %}
                </ul>
            </nav>
            {% endif %}
        </div>

        <div class="col-3">
            <p style="text-align: right; color: #858585;">Quantity: {{ tickets_quantity }}</p>
        </div>

    </div>

</div>
{% endblock %}

